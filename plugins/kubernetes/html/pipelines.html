<div class="row" ng-controller="Kubernetes.PipelinesController">
  <script type="text/ng-template" id="hostLinkTemplate.html">
    <div class="ngCellText">
    </div>
  </script>
  <div class="row">
    <div class="col-md-12" ng-show="pipelines.length">
      <span ng-show="!id">
        <hawtio-filter ng-model="filterText"
                       css-class="input-xxlarge"
                       placeholder="Filter builds..."></hawtio-filter>
      </span>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div ng-hide="fetched">
        <div class="align">
          <i class="fa fa-spinner fa-spin"></i>
        </div>
      </div>
      <div ng-show="fetched">
        <div ng-hide="pipelines.length" class="align-center">
          <p class="alert alert-info">There are no build pipelines available.</p>
          <a class="btn btn-primary" href="/kubernetes/buildConfig">Create Build Configuration</a>
        </div>
      </div>
    </div>
  </div>
  <div ng-show="fetched && pipelines.length">
    <div ng-repeat="pipeline in pipelines | filter:filterText">
      <div class="row">
        <div class="col-md-12">

          <div id="container"
               style="
            background: lightgrey;
            border-radius: 4px;"
               hawtio-auto-columns=".ex-children"
               min-margin="5">
            <div class="ex-children {{step.$class}}"
                 style="display: inline-block;
              border-radius: 4px;
              text-align: center;
              vertical-align: middle;
              height: 80px;
              border: 20px;
              margin: 5px;"
                 ng-repeat="step in pipeline.triggersSteps">
              <span ng-switch="step.buildConfig.kind">
                <span ng-switch-default="">
                  <div class="pipeline-build-details">
                    <a title="View details for this build configuration"
                       href="/kubernetes/buildConfigs/{{step.buildConfig.metadata.name}}">
                      <i class="fa fa-cog"></i>
                      {{step.buildConfig.metadata.name}}
                    </a>
                  </div>
                  <div class="pipeline-last-build" ng-show="step.buildConfig.$lastBuild">
                    <a href="{{step.buildConfig.$lastBuild.$viewLink}}" title="view this build">
                      <i class="fa fa-info"></i>
                      build
                    </a>
                  </div>
                    <div class="ngCellText" class="pipeline-last-build-time"
                         title="last build was at: {{step.buildConfig.$lastBuild.$creationDate | date : 'h:mm:ss a, EEE MMM yyyy'}}">
                      <div ng-switch="step.buildConfig.$lastBuild.status">
                        <span ng-switch-when="New" class="text-primary">
                          <i class="fa fa-spin fa-spinner"></i> new: {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                        <span ng-switch-when="Pending" class="text-primary">
                          <i class="fa fa-spin fa-spinner"></i> pending: {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                        <span ng-switch-when="Running" class="text-primary">
                          <i class="fa fa-spin fa-spinner"></i> running {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                        <span ng-switch-when="Complete" class="text-success">
                          <i class="fa fa-check-circle"></i> completed {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                        <span ng-switch-when="Failed" class="text-danger">
                          <i class="fa fa-exclamation-circle"></i> failed {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                        <span ng-switch-default class="text-warning">
                          <i class="fa fa-exclamation-triangle"></i> {{step.buildConfig.$lastBuild.status}}: {{step.buildConfig.$lastBuild.$creationDate.relative()}}
                        </span>
                      </div>
                    </div>
                  <div class="pipeline-last-build-logs">
                    <a href="{{step.buildConfig.$lastBuild.$logsLink}}" title="view the logs of this build">
                      <i class="fa fa-file-text-o"></i>
                      logs
                    </a>
                  </div>
                </span>
                <span ng-switch-when="DeploymentConfig">
                  <div class="pipeline-build-details">
                    <a title="View details for this deployment configuration"
                       href="/kubernetes/deploymentConfigs/{{step.buildConfig.metadata.name}}">
                      <i class="fa fa-cogs"></i>
                      {{step.buildConfig.metadata.name}}
                    </a>
                  </div>
                  <div class="pipline-deploy-pods">
                  <span class="pipeline-pod-counts" ng-show="step.$podCounters">pods:
                    <a ng-show="step.$podCounters.podsLink" target="pods" href="{{step.$podCounters.podsLink}}"
                       title="View pods for this deployment">
                      <span class="badge badge-success">{{step.$podCounters.valid}}</span>
                      <span ng-show="step.$podCounters.waiting" class="badge">{{step.$podCounters.waiting}}</span>
                      <span ng-show="step.$podCounters.error"
                            class="badge badge-warning">{{step.$podCounters.error}}</span>
                    </a>
                  </span>
                  </div>
                </span>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
